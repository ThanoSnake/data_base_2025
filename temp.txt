


🔹 Procedure: MatchResaler
Περιγραφή:
Η αποθηκευμένη διαδικασία MatchResaler ενεργοποιείται όταν ένας επισκέπτης επιθυμεί να μεταπωλήσει το εισιτήριό του και ελέγχει αν υπάρχει κάποιος συμβατός ενδιαφερόμενος αγοραστής σε εκκρεμότητα στη λίστα buyer_interest_queue. Αρχικά, ανακτά το event_id και την category του εισιτηρίου προς μεταπώληση. Στη συνέχεια, εντοπίζει τον πρώτο διαθέσιμο ενδιαφερόμενο αγοραστή (με βάση τη σειρά προτεραιότητας request_time) που είτε έχει ζητήσει συγκεκριμένο ticket_id, είτε εισιτήριο του ίδιου event και κατηγορίας. Αν ο ενδιαφερόμενος δεν είναι ήδη εγγεγραμμένος ως επισκέπτης (visitor_id IS NULL), δημιουργείται νέος λογαριασμός στη visitor με τα στοιχεία του (buyer_name, age). Το εισιτήριο μεταβιβάζεται στον νέο ή υφιστάμενο επισκέπτη και η μεταπώληση ολοκληρώνεται με ενημέρωση των resale_queue και buyer_interest_queue, μαρκάροντας τις σχετικές εγγραφές ως ολοκληρωμένες (is_completed = TRUE, is_fulfilled = TRUE). Η διαδικασία αυτοματοποιεί και διασφαλίζει την άμεση αντιστοίχιση ανάμεσα σε πωλητές και αγοραστές, ενισχύοντας την ομαλή λειτουργία της αγοράς μεταπωλήσεων.
